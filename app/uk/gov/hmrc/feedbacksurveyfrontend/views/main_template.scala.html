@import uk.gov.hmrc.renderer.TemplateRenderer
@import uk.gov.hmrc.play.views.html.layouts
@import uk.gov.hmrc.urls.Link

@(title: String,
  serviceTitle: Option[String] = None,
  pageScripts: Option[Html] = None,
  sidebarLinks: Option[Html] = None,
  bodyClasses: Option[String] = None,
  mainClass: Option[String] = None,
  userLoggedIn: Boolean = false,
  langReturnUrl: Option[String] = None,
  scriptElem: Option[Html] = None)(mainContent: Html)(implicit request : Request[_], messages: play.api.i18n.Messages, templateRenderer: TemplateRenderer)

@serviceInfoContent = {}

@sidebar = {
  @if(sidebarLinks.isDefined) {
   @layouts.sidebar(sidebarLinks.get, Some("sidebar"))
  }
}

@inlineScript = {

  @if(uk.gov.hmrc.feedbacksurveyfrontend.FrontendAppConfig.analyticsToken == "N/A") {
    <script type="text/javascript">
      var ga = function(send, event, category, action, label, args) {
        console.log(JSON.stringify({
          call: 'ga',
          send: send,
          event: event,
          category: category,
          action: action,
          label: label
        }));

        if (args && typeof args !== 'undefined' && typeof args['hitCallback'] === 'function' ) {
          args['hitCallback']();
        }
      };
    </script>
  }
}

@mainContentHeader = {

  @langReturnUrl.map { url =>
    <div class="lang-select">
      @if(messages.lang == Lang("cy")) {
        @Link.toInternalPage(
          url=controllers.routes.LanguageController.enGb(url).toString(),
          value=Some(Messages("label.english")),
          id=Some("switch-to-english"),
          cssClasses=Some("ga-track-anchor-click"),
          dataAttributes=Some(Map(
            "ga-event-category" -> "link - click",
            "ga-event-action" -> "lang-select",
            "ga-event-label" -> "English"))
          ).toHtml
        | @Messages("label.welsh")
      } else {
        @Messages("label.english") |
        @Link.toInternalPage(
          url=controllers.routes.LanguageController.cyGb(url).toString(),
          value=Some(Messages("label.welsh")),
          id=Some("switch-to-welsh"),
          cssClasses=Some("ga-track-anchor-click"),
          dataAttributes=Some(Map(
            "ga-event-category" -> "link - click",
            "ga-event-action" -> "lang-select",
            "ga-event-label" -> "Cymraeg"))
          ).toHtml
      }
    </div>
  }
}

@{
  templateRenderer.renderDefaultTemplate(
    layouts.article(mainContent, false, None), Map[String, Any](
      "pageTitle" -> Messages(title),
      "navTitle" -> Messages("feedbackSurvey.giveFeedBack"),
      "hideAccountMenu" -> true,
      "linkElems" -> Map(
        "url" -> routes.Assets.at("stylesheets/custom.css")
      ),
      "scriptElems" -> Seq(
        Map("url" -> routes.Assets.at("javascripts/feedback.js")),
        Map("url" -> routes.Assets.at("javascripts/gaTracking.js")),
        Map("url" -> routes.Assets.at("javascripts/jquery.min.js")),
        Map("url" -> routes.Assets.at("javascripts/jquery-ui.min.js"))
      ),
      "inlineScript" -> inlineScript,
      "betaBanner" -> true,
      "feedbackIdentifier" -> "FANDF",
      "includeHMRCBranding" -> true,
      "isWelsh" -> messages.lang.code.equals("cy"),
      "getHelpForm" -> uk.gov.hmrc.feedbacksurveyfrontend.LocalPartialRetriever.getPartialContent(uk.gov.hmrc.feedbacksurveyfrontend.FrontendAppConfig.reportAProblemPartialUrl),
      "mainContentHeader" -> mainContentHeader
    )
  )
}
